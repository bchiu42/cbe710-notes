

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>The Canonical Ensemble &#8212; Notes for CBE710</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/defs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lecture_files/Lecture3';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="— Problem Set 1 —" href="../problems/ps_1/problem_set_1.html" />
    <link rel="prev" title="The Microcanonical Ensemble" href="Lecture2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    <p class="title logo__title">Notes for CBE710</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Class introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Statistical Mechanics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Lecture1A.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture1B.html">Review of thermodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture2.html">The Microcanonical Ensemble</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">The Canonical Ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="../problems/ps_1/problem_set_1.html">— Problem Set 1 —</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture4.html">Canonical Ensemble Continued</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture5.html">Generalized Ensembles</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture6.html">The Ideal Gas Partition Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture7.html">The Langmuir Isotherm and Ising Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture8.html">The Ising Model and Mean-Field Theory</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Molecular Simulation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Lecture9.html">Fluctuations and an Introduction to Molecular Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture10.html">Monte Carlo Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture11.html">Monte Carlo and Intro to Molecular Dynamics Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture12.html">MD Thermostats</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture13.html">The Structure of Classical Fluids</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture14.html">The Potential of Mean Force</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Thermodynamics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Lecture15.html">Free energy perturbation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture16.html">Postulates of thermodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture17.html">Heat Engines and Possible Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture18.html">Entropy</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture19.html">The Fundamental Relation of Thermodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture20.html">Legendre Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture21.html">Conditions of equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture22.html">Equilibrium in single-component systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture23.html">Phase Diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture24.html">Fugacity</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture25.html">Ideal mixtures</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture26.html">Non-ideal mixtures</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lecture_files/Lecture3.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>The Canonical Ensemble</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-readings-for-the-enthusiast">Additional Readings for the Enthusiast</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topics-in-this-lecture">Topics in this lecture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-of-the-microcanonical-ensemble-two-state-system">Application of the microcanonical ensemble: two-state system</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combinatorics">Combinatorics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stirling-s-approximation">Stirling’s approximation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#back-to-the-example">Back to the example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-the-canonical-ensemble">Introduction to the canonical ensemble</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="the-canonical-ensemble">
<h1>The Canonical Ensemble<a class="headerlink" href="#the-canonical-ensemble" title="Permalink to this headline">#</a></h1>
<section id="additional-readings-for-the-enthusiast">
<h2>Additional Readings for the Enthusiast<a class="headerlink" href="#additional-readings-for-the-enthusiast" title="Permalink to this headline">#</a></h2>
<p><span id="id1">McQuarrie [<a class="reference internal" href="Lecture2.html#id5" title="Donald A. McQuarrie. Statistical mechanics. University Science Books, Sausalito, Calif, 2000. ISBN 978-1-891389-15-3. URL: https://vuquangnguyen2016.files.wordpress.com/2017/12/339279795-donald-a-mcquarrie-statistical-mechanics-bookzz-org.pdf.">2</a>]</span>, Chapter 1, Chapter 2.1</p>
<p><span id="id2">Chandler [<a class="reference internal" href="Lecture2.html#id4" title="David Chandler. Introduction to Modern Statistical Mechanics. Oxford University Press, New York, 1st edition edition, September 1987. ISBN 978-0-19-504277-1. URL: http://pcossgroup.xmu.edu.cn/old/users/xlu/group/courses/apc/imsm_chandler.pdf.">1</a>]</span>, Chapter 3.1-3.4</p>
</section>
<section id="topics-in-this-lecture">
<h2>Topics in this lecture<a class="headerlink" href="#topics-in-this-lecture" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Example of microcanonical ensemble</p></li>
<li><p>Stirling’s approximation</p></li>
<li><p>Canonical partition function</p></li>
</ul>
</section>
<section id="application-of-the-microcanonical-ensemble-two-state-system">
<h2>Application of the microcanonical ensemble: two-state system<a class="headerlink" href="#application-of-the-microcanonical-ensemble-two-state-system" title="Permalink to this headline">#</a></h2>
<p>In the last lecture, we introduced the concept of the microcanonical
ensemble, which we defined as the set of all possible microstates
associated with a macrostate in which the number of particles (<span class="math notranslate nohighlight">\(N\)</span>), the
volume (<span class="math notranslate nohighlight">\(V\)</span>), and the energy (<span class="math notranslate nohighlight">\(E\)</span>) are constant. We then defined several
postulates of statistical mechanics, which we summarize as:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Y_\textrm{obs} = \langle Y \rangle\)</span>: the ergodic hypothesis, where
<span class="math notranslate nohighlight">\(\langle Y \rangle = \sum_i^\textrm{states} p_i Y_i\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(p_i = \frac{1}{\Omega(N,V,E)}\)</span>: the principle of equal a priori
probabilities, where <span class="math notranslate nohighlight">\(\Omega(N,V,E)\)</span> is the degeneracy (or number of
states) of the microcanonical ensemble</p></li>
<li><p><span class="math notranslate nohighlight">\(S = k_B \ln \Omega(N,V,E)\)</span>: the definition of the Boltzmann
entropy.</p></li>
</ul>
<p>We will now use an example to illustrate how the microcanonical ensemble
can provide information about the thermodynamic properties of a system.
Consider a polymer chain that adsorbs to an attractive surface. The
chain is composed of <span class="math notranslate nohighlight">\(N\)</span> monomers that do not interact with each other.
The surface is attractive such that a single monomer adsorbs favorably
with an energy <span class="math notranslate nohighlight">\(-\epsilon\)</span>. If we assume the energy of the free monomers
is 0 and there are no monomer-monomer interactions, then the total
energy of the system for <span class="math notranslate nohighlight">\(n\)</span> adsorbed monomers is:</p>
<div class="math notranslate nohighlight">
\[E = \sum_i^N \epsilon_i = -n \epsilon\]</div>
<p>The question we will ask is - how does the energy of the system (or,
equivalently, the number of adsorbed monomers) depend on the
temperature?</p>
<p><img alt="image" src="../_images/fig_2_4.png" />{width=”100%”}</p>
<p>We know the following relationships:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\left ( \frac{\partial E}{\partial S} \right )_V = T\)</span> from
thermodynamics</p></li>
<li><p><span class="math notranslate nohighlight">\(E = -n \epsilon\)</span> from the microscopic description of the system
given above</p></li>
<li><p><span class="math notranslate nohighlight">\(S = k_B \ln \Omega (E)\)</span> from the definition of the entropy of the
microcanonical ensemble using the shorthand version of
<span class="math notranslate nohighlight">\(\Omega(N,V,E)\)</span></p></li>
</ul>
<p>Given these relationships, we can use the equations of the
microcanonical ensemble to relate the degeneracy to the entropy and then
identify a relationship between the energy and temperature from
thermodynamics. Thus, we will describe our system as having a constant
energy - that is, we assume that <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(E\)</span> are fixed and then will
derive a temperature dependence based on this assumption. There may be
another ensemble that is more appropriate - for example, we may assume
the temperature is constant, instead, and choose a different ensemble
(e.g. the canonical ensemble) to solve for the temperature dependence.
If we are consistent in our assumptions and mathematical framework, then
any ensemble is fine (as long as the fixed thermodynamic variables in
the ensemble do not violate some feature of the system) and we will
return to this problem with alternative ensembles in future lectures.</p>
<p>We need to start by computing an expression for the degeneracy.
Recalling previous sections, we know that <span class="math notranslate nohighlight">\(\Omega(E)\)</span> is defined as the
number of microstates that have the same energy <span class="math notranslate nohighlight">\(E = - n\epsilon\)</span>. Since
the number of total monomers, <span class="math notranslate nohighlight">\(N\)</span>, is greater than the number of
adsorbed monomers, <span class="math notranslate nohighlight">\(n\)</span>, there are many possible ways to choose the the
set of <span class="math notranslate nohighlight">\(n\)</span> adsorbed monomers from the total set of <span class="math notranslate nohighlight">\(N\)</span> monomers, but any
set of <span class="math notranslate nohighlight">\(n\)</span> that we select will have the same energy. Therefore, the
degeneracy of this system is equal to the number of unique ways to
select <span class="math notranslate nohighlight">\(n\)</span> monomers that adsorb to the surface out of the possible set
of <span class="math notranslate nohighlight">\(N\)</span> - or in other words, the number of unique ways to split the <span class="math notranslate nohighlight">\(N\)</span>
monomers into two groups (adsorbed and free). Computing this quantity
will motivate a mathematical aside.</p>
<section id="combinatorics">
<h3>Combinatorics<a class="headerlink" href="#combinatorics" title="Permalink to this headline">#</a></h3>
<p>Imagine that you have <span class="math notranslate nohighlight">\(N\)</span> objects. In general, objects can either be
<strong>distinguishable</strong>, such as playing cards, or <strong>indistinguishable</strong>,
such as identical marbles. A common question we will face is how many
ways we can uniquely divide <span class="math notranslate nohighlight">\(N\)</span> distinguishable objects into groups. We
can calculate this using playing cards as an example. First, we can
count the number of unique ways to shuffle a deck of <span class="math notranslate nohighlight">\(N\)</span> distinguishable
playing cards. We can imagine placing the first card on the top of the
deck; there are <span class="math notranslate nohighlight">\(N\)</span> possible choices for the first card. Next, we can
imagine placing the next card on the top of the deck. Since we have
removed 1 card, there are now <span class="math notranslate nohighlight">\(N-1\)</span> choices remaining, so there are
<span class="math notranslate nohighlight">\(N(N-1)\)</span> unique choices for placing the first two cards, and so on. This
leads to:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\text{\# of arrangements} &amp;= N(N-1)(N-2) \dots (2)(1) \nonumber \\
&amp;= N!
\end{aligned}\end{split}\]</div>
<p>If the playing cards were instead indistinguishable, then there would
instead be only unique 1 arrangement of playing cards since switching
the order of any two cards would not result in an observable change to
the order of the deck. Now, we consider the question how many ways there
are to divide <span class="math notranslate nohighlight">\(N\)</span> distinguishable playing cards into two groups, one
containing <span class="math notranslate nohighlight">\(n_1\)</span> cards and the second containing <span class="math notranslate nohighlight">\(N-n_1\)</span> cards.
Following the same reasoning as above, for the first group we have <span class="math notranslate nohighlight">\(N\)</span>
options for the first card, <span class="math notranslate nohighlight">\(N-1\)</span> for the second, and so on, until for
the last selection we have <span class="math notranslate nohighlight">\(N-n_1+1\)</span> choices. The total number of
arrangements for group 1 is thus:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}\begin{aligned}
N(N-1)(N-2)\dots(N-n_1+1) &amp;= \frac{N(N-1)(N-2)\dots(2)(1)}{(N-n_1)(N-n_1-1)\dots(2)(1)} \nonumber \\ 
&amp;= \frac{N!}{(N-n_1)!}
\end{aligned}$$  The second group has $N-n_1!$ choices for placing the
remaining $N-n_1$ cards, so that in total there are
$\left [ N!/(N-n_1)!\right ] \times (N-n_1)! = N!$ arrangements of the
two groups. However, the question asked for how many ways there are to
**divide** them into two groups; the arrangement of cards within each
group does not matter, as placing the same $n_1$ cards in the group in
any order is still the same division. There are $n_1!$ ways to arrange
the $n_1$ cards in the first group and $(N-n_1)!$ ways to arrange the
cards in the second group, so in total we have overcounted by
$n_1!(N-n_1)!$ since every division into a group of $n_1$ and $N-N_1$
was counted an extra $n_1!(N-n_1)!$ times associated with different
orders of the cards. Thus, the total number of unique ways of dividing
the cards into two groups if the order within each group doesn't matter
is:\end{split}\\$$\text{\# of divisions} = \frac{N!}{n_1!(N-n_1)!}\end{aligned}\end{align} \]</div>
<p>This expression appears in the binomial expansion and is referred to as
the binomial coefficient, and can be expanded to any number of groups
following similar reasoning.</p>
</section>
<section id="stirling-s-approximation">
<h3>Stirling’s approximation<a class="headerlink" href="#stirling-s-approximation" title="Permalink to this headline">#</a></h3>
<p>We have just seen an example of a calculation that uses factorials,
which can become difficult to treat algebraically. Fortunately, there is
an approximation that simplifies the use of factorials. Because <span class="math notranslate nohighlight">\(N!\)</span> is
a product, it is easier to deal with <span class="math notranslate nohighlight">\(\ln N!\)</span> which is a sum. We can
write:</p>
<div class="math notranslate nohighlight">
\[\ln N! = \sum_{m=1}^N \ln m\]</div>
<p>The value of this sum is equal to the total area of a series of
rectangles, each with height <span class="math notranslate nohighlight">\(\ln m\)</span> and width <span class="math notranslate nohighlight">\(dm = 1\)</span>. That is, we can
equate the sum to the integral of <span class="math notranslate nohighlight">\(\ln m\)</span> using rectangular integration.
As <span class="math notranslate nohighlight">\(N\)</span> increases, the difference between successive terms in the sum
will become very small - if <span class="math notranslate nohighlight">\(N \gg 1\)</span>, the difference in the terms
becomes:</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
\ln (m+1) - \ln m = \ln \frac{m+1}{m} \approx \ln 1 \approx 0 \quad \text{for $m\gg1$}
\end{aligned}\]</div>
<p>Therefore, for <span class="math notranslate nohighlight">\(N\gg1\)</span> we can replace the sum over discrete values of
<span class="math notranslate nohighlight">\(m\)</span> with an integral over continuous values of <span class="math notranslate nohighlight">\(m\)</span> - effectively
allowing the width of each rectangle (<span class="math notranslate nohighlight">\(dm\)</span>) to shrink to an
infinitesimal value. The error between the approximation using an
integral and the exact sum over integer values of <span class="math notranslate nohighlight">\(m\)</span> is very small once
<span class="math notranslate nohighlight">\(N\)</span> is large. The resulting approximation allows us to write:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\ln N! &amp;= \sum_{m=1}^N \ln m \nonumber \\
&amp;\approx \int_1^N \ln m dm  \quad \text{if $N \gg 1$} \nonumber\\
&amp;= \boxed{N \ln N - N} \label{stirling}
\end{aligned}\end{split}\]</div>
<p>Equation <span class="xref myst">[stirling]</span>{reference-type=”ref”
reference=”stirling”} is <strong>Stirling’s approximation</strong>, and differs by
less than 1% from <span class="math notranslate nohighlight">\(\ln N!\)</span> if <span class="math notranslate nohighlight">\(N &gt; 50\)</span>. We will make frequent use of
Stirling’s approximation, and moreover we will often approximate
summations as integrals, throughout the course. We will return to
solving the example using Stirling’s approximation and combinatorics in
the next lecture.</p>
<p><img alt="image" src="../_images/fig_2_5.png" />{width=”100%”}</p>
</section>
<section id="back-to-the-example">
<h3>Back to the example<a class="headerlink" href="#back-to-the-example" title="Permalink to this headline">#</a></h3>
<p>Having defined methods for splitting objects into two groups, we can now
count how many ways there are to separate <span class="math notranslate nohighlight">\(N\)</span> monomers into a group of
<span class="math notranslate nohighlight">\(n\)</span> that are adsorbed to a surface and <span class="math notranslate nohighlight">\(N-n\)</span> that are not which defines
the degeneracy of a microcanonical ensemble with
<span class="math notranslate nohighlight">\(\langle E \rangle = n\epsilon\)</span>. We thus write an expression for
<span class="math notranslate nohighlight">\(\Omega(E)\)</span> and the entropy based on the combinatorics expression above:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\Omega(E) &amp;= \frac{N!}{n!(N-n)!} \\
S &amp;= k_B \ln \Omega(E) \nonumber\\
&amp;= k_B \ln \left ( \frac{N!}{n!(N-n)!} \right )
\end{aligned}\end{split}\]</div>
<p>To simplify the expression for the entropy, we can invoke Stirling’s
approximation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
S &amp;= k_B \ln \left ( \frac{N!}{n_1!(N-n)!} \right ) \\
&amp;= k_B \left [\ln N! - \ln n! - \ln(N-n)! \right ] \\
&amp;\approx k_B \left ( [ N \ln N - N] - [n \ln n - n] - [(N-n) \ln (N-n) - (N-n)] \right ) \\
&amp;= k_B \left ( N \ln N - n\ln n - (N-n)\ln (N-n) \right ) \label{entropysimple}
\end{aligned}\end{split}\]</div>
<p>Now we will simplify this expression with some algebra, defining
<span class="math notranslate nohighlight">\(n/N \equiv \alpha\)</span> for convenience:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
S &amp;= k_B \left ( N \ln N - n \ln n - (N-n)(\ln N + \ln (1-\alpha))\right ) \\
&amp;= k_B \left ( N \ln N - n \ln n - N \ln N - N \ln (1 - \alpha) + n \ln N + n \ln (1-\alpha) \right ) \\
&amp;= k_B \left ( (n - N) \ln (1 - \alpha) -n \ln \alpha  \right ) \\
&amp;=- k_B N \left [ (1 - \alpha) \ln (1- \alpha) + \alpha \ln \alpha \right ]
\end{aligned}\end{split}\]</div>
<p>Recognizing that entropy and energy that we define here are equvalent to
their macroscopic definitions (according to Postulate 1 and 2) we can
use <span class="math notranslate nohighlight">\(\left ( \frac{\partial E}{\partial S} \right )_V = T\)</span> and the chain
rule to derive a temperature dependence in terms of the total system
energy, <span class="math notranslate nohighlight">\(E = \langle E \rangle = -n \epsilon\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\left ( \frac{\partial E}{\partial S} \right )_V &amp;= T \\
-\left ( \frac{\partial S}{\partial (n \epsilon)} \right )_V &amp;= \frac{1}{T} \\
-\frac{1}{\epsilon} \left (\frac{\partial S}{\partial \alpha} \right )_V \left ( \frac{\partial \alpha}{\partial n} \right )_V &amp;= \frac{1}{T} \\
-\frac{1}{N\epsilon} \left (\frac{\partial S}{\partial \alpha} \right )_V &amp;= \frac{1}{T}  \\
-\frac{k_B }{\epsilon} \left (\ln(1-\alpha) - \ln \alpha \right ) &amp;= \frac{1}{T}  \\
\ln \frac{1-\alpha}{\alpha} &amp;= -\frac{\epsilon}{k_BT}  \\
\frac{1}{\alpha} = 1 +  e^{-\epsilon / k_BT} 
\end{aligned}\end{split}\]</div>
<p>Finally, we simplify by recognizing that <span class="math notranslate nohighlight">\(\alpha = n/N\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\frac{N}{n} &amp;= 1 +  e^{-\epsilon / k_BT} \\
&amp;\boxed{n = \frac{N}{ 1 +  e^{-\epsilon / k_BT}}} \label{twostatemicrofinal}
\end{aligned}\end{split}\]</div>
<p>Equation
<span class="xref myst">[twostatemicrofinal]</span>{reference-type=”ref”
reference=”twostatemicrofinal”} relates the number of adsorbed monomers
to microscopic features (i.e. the adsorption energy per monomer and
total number of monomers) as a function of the system temperature. As
<span class="math notranslate nohighlight">\(T\)</span> goes to 0, we expect the system to be in an energy-minimizing
configuration with all monomers bound - indeed, as <span class="math notranslate nohighlight">\(T\rightarrow 0\)</span>,
<span class="math notranslate nohighlight">\(n\rightarrow N\)</span>, indicating that all monomers adsorb. In the opposite
extreme, as <span class="math notranslate nohighlight">\(T \rightarrow \infty\)</span>, <span class="math notranslate nohighlight">\(n\rightarrow N/2\)</span>, indicating that
at infinite temperature exactly half of the monomers bind to the
surface. This makes conceptual sense - if we have infinite thermal
energy, the energy for adsorption is negligible so adsorbing or not
adsorbing is equally likely for each monomer (we will revisit this
result in future lectures).</p>
<p>This example illustrates the basic principles of the statistical
mechanics approach: we begin by identifying a set of constant
macroscopic thermodynamic variables for the system (<span class="math notranslate nohighlight">\(NVE\)</span>), choose an
appropriate statistical ensemble (microcanonical) corresponding to these
variables, calculate the value for a thermodynamic variable (entropy)
from ensemble properties based on our microscopic picture of the system,
then use thermodynamic relations to get additional information about the
system (temperature). Note that our final result seems to contradict our
assumption - we explicitly derive a relationship between the energy and
the temperature, showing that the energy is not, in fact, constant.
Recall, though, that the problem statement itself (i.e. the microscopic
description of the system) does not specific a constant energy - we
<strong>choose</strong> to describe our system in such a way that the energy is held
constant, then apply the equations of the microcanonical ensemble
(consistent with our choice) to derive the temperature dependence. We
also could have derived the same result by assuming that the system is
held at constant temperature and that the energy is allowed to vary, and
achieve the same result (we will do this next lecture). We will find
several variations of this basic approach, and will illustrate that the
correct choice of thermodynamic variables, even for the same system, can
dramatically simplify problem solutions.</p>
</section>
</section>
<section id="introduction-to-the-canonical-ensemble">
<h2>Introduction to the canonical ensemble<a class="headerlink" href="#introduction-to-the-canonical-ensemble" title="Permalink to this headline">#</a></h2>
<p>In principle, all calculations in statistical mechanics can be performed
using the microcanonical ensemble by deriving relationships based on a
fixed set of constant energy states. In practice, the microcanonical
ensemble is often not convenient because in many cases the energy of the
system is not fixed. For example, most laboratory experiments take place
in environments in which the energy of the system is able to exchange
with the environment; that is, the walls of the system are
<strong>diathermal</strong>. <span class="math notranslate nohighlight">\(E\)</span> is therefore no longer a fixed quantity and instead
varies between each microstate. At equilibrium, however, we know from
thermodynamics that the temperature of the system will be equal to the
temperature of the environment. It would therefore be ideal to have
equations describing systems in which the temperature is fixed in each
microstate due to this condition of equilibrium while the energy is
allowed to vary. The ensemble of microstates for a system at constant
temperature (and number and volume) is the canonical ensemble or <span class="math notranslate nohighlight">\(NVT\)</span>
ensemble. As we will see, choosing the appropriate ensemble to describe
a system of interest is essential in simplifying problem solutions.
However, if we allow the energy to vary between each microstate then the
probability that a system obtains a given state, <span class="math notranslate nohighlight">\(p_i\)</span>, is no longer a
constant value - that is, Postulate 2 no longer applies. We thus will
derive an expression for the probability of microstate <span class="math notranslate nohighlight">\(i\)</span> in order to
calculate ensemble-average quantities for the canonical ensemble.</p>
<p>Let us consider a system of interest that is contact with surroundings
that we will refer to as the <strong>bath</strong>. The bath is significantly larger
than the system of interest, so that the energy and number of particles
in the bath are also much larger than the energy and number of particles
in the system. Thermodynamic parameters associated with the system will
be denoted with the subscript <span class="math notranslate nohighlight">\(S\)</span>, parameters associated with the bath
will be denoted with the subscript <span class="math notranslate nohighlight">\(B\)</span>, and parameters associated with
the total combination of system and bath will be denoted with the
subscript <span class="math notranslate nohighlight">\(T\)</span>. We assume that the walls of the system prevent the
exchange of particles and volume so that <span class="math notranslate nohighlight">\(N_S\)</span> and <span class="math notranslate nohighlight">\(V_S\)</span> are fixed;
however, the energy, <span class="math notranslate nohighlight">\(E_S\)</span>, can exchange with the surrounding bath. At
thermal equilibrium, the temperature of the bath and system are
equivalent (<span class="math notranslate nohighlight">\(T_S = T_B \equiv T_T\)</span>). A physical realization of such a
system would be a sealed box with conducting walls that allows heat to
exchange with the outside environment. Finally, we assume that the
<em>total</em> energy, <span class="math notranslate nohighlight">\(E_T\)</span>, of the bath plus the system is a constant (i.e.,
exchanges of energy between the bath and system obey conservation of
energy):</p>
<div class="math notranslate nohighlight">
\[E_T = E_S + E_B = \text{constant}\]</div>
<p>The total combination of system and bath is isolated; this assumption is
generally true of the universe, for example. Microstates of the total
isolated system belong to the microcanonical ensemble, but the energy of
each of these microstates is <strong>partitioned</strong> between the system of
interest and the bath. The canonical ensemble then refers to the
ensemble of microstates describing the system of interest, in which the
energy may vary between microstates in the ensemble.</p>
<p><img alt="image" src="../_images/fig_3_2.png" />{width=”100%”}</p>
<p>The system is characterized by <span class="math notranslate nohighlight">\(N_S\)</span>, <span class="math notranslate nohighlight">\(V_S\)</span>, and <span class="math notranslate nohighlight">\(E_S\)</span>, and connected to
a bath with <span class="math notranslate nohighlight">\(N_B\)</span>, <span class="math notranslate nohighlight">\(V_B\)</span>, and <span class="math notranslate nohighlight">\(E_B\)</span>. We will now determine the
probability <span class="math notranslate nohighlight">\(p_j\)</span> of observing a single microstate of the system, <span class="math notranslate nohighlight">\(j\)</span>,
which has energy <span class="math notranslate nohighlight">\(E_j\)</span> (noting that there can be many possible
microstates with the same energy - in fact, there is a microcanonical
ensemble of microstates with the same energy! We use the subscript <span class="math notranslate nohighlight">\(j\)</span>
to denote a single specific microstate - that is, a single arrangement
of particles with a specific energy <span class="math notranslate nohighlight">\(E_j\)</span> out of the many possible
microstates that would have the same energy). Since the energy of the
system is fixed and equal to <span class="math notranslate nohighlight">\(E_j\)</span>, the energy of the bath is also fixed
and equal to <span class="math notranslate nohighlight">\(E_B=E_T-E_j\)</span>. Imagine taking a snapshot of the <span class="math notranslate nohighlight">\(N_S\)</span>
particles in microstate <span class="math notranslate nohighlight">\(j\)</span> and counting the subset of all possible
microstates of the total isolated system for which the system has
exactly the particle positions/energies specified for microstate <span class="math notranslate nohighlight">\(j\)</span>.
Alternatively, you could imagine fixing the positions/energies of the
<span class="math notranslate nohighlight">\(N_S\)</span> particles into microstate <span class="math notranslate nohighlight">\(j\)</span> and then counting all possible
combinations of the positions/energies of the <span class="math notranslate nohighlight">\(N_B\)</span> remaining particles.
Either approach would yield the number of microstates of the <strong>total
combined system</strong> in which the system of interest is in the particular
microstate <span class="math notranslate nohighlight">\(j\)</span>. This value is equal to the number of microstates of the
<strong>bath</strong> that are possible for the given microstate of the <strong>system</strong>.
Since the energy of the bath is itself fixed, this number of states is
equal to the degeneracy of a bath microcanonical ensemble with energy
<span class="math notranslate nohighlight">\(E_T-E_j\)</span>, or <span class="math notranslate nohighlight">\(\Omega(N_B,V_B,E_T-E_j)\)</span>. We could write a similar
degeneracy for each possible microstate of the system. Since the total
isolated system is a microcanonical ensemble in which all microstates
are equally probable, the probability of observing a single microstate
of the system <span class="math notranslate nohighlight">\(j\)</span> is equal to the number of microstates of the total
isolated system in which the system of interest is in microstate <span class="math notranslate nohighlight">\(j\)</span>
divided by the total number of microstates of the combined isolated
system.</p>
<p><img alt="image" src="../_images/fig_3_3.png" />{width=”100%”}</p>
<p>From the logic above, we can write the normalized probability of finding
microstate <span class="math notranslate nohighlight">\(j\)</span> of the system in terms of the degeneracy of the bath as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
p_j &amp;= \frac{\Omega(N_B, V_B, E_T-E_j)}{\sum_j^{\textrm{system microstates}} \Omega(N_B, V_B, E_T-E_j)} \\
&amp;= \frac{\Omega(N_B, V_B, E_T-E_j)}{C_1}
\end{aligned}\end{split}\]</div>
<p>That is, the probability of finding a particular microstate in the
<strong>canonical ensemble</strong> (of the system) is related to the degeneracy of a
bath described by a <strong>microcanonical ensemble</strong> with energy <span class="math notranslate nohighlight">\(E_T-E_j\)</span>.
We use the constant <span class="math notranslate nohighlight">\(C_1\)</span> to refer to the normalization factor in the
denominator (this quantity will drop out later on in the derivation). We
will proceed from here in the next lecture by relating the degeneracy of
the bath microcanonical ensemble to the entropy (following our previous
approach) and from there obtaining an expression for <span class="math notranslate nohighlight">\(p_j\)</span> that does not
depend on any properties of the bath.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lecture_files"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Lecture2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">The Microcanonical Ensemble</p>
      </div>
    </a>
    <a class="right-next"
       href="../problems/ps_1/problem_set_1.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">— Problem Set 1 —</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-readings-for-the-enthusiast">Additional Readings for the Enthusiast</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topics-in-this-lecture">Topics in this lecture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-of-the-microcanonical-ensemble-two-state-system">Application of the microcanonical ensemble: two-state system</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combinatorics">Combinatorics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stirling-s-approximation">Stirling’s approximation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#back-to-the-example">Back to the example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-the-canonical-ensemble">Introduction to the canonical ensemble</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Reid van Lehn, Matt Gebbie, Rose Cersonsky
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>