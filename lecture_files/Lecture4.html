

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Canonical Ensemble Continued &#8212; Notes for CBE710</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/defs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lecture_files/Lecture4';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Generalized Ensembles" href="Lecture5.html" />
    <link rel="prev" title="— Problem Set 1 —" href="../problems/ps_1/problem_set_1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    <p class="title logo__title">Notes for CBE710</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Class introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Statistical Mechanics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Lecture1A.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture1B.html">Review of thermodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture2.html">The Microcanonical Ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture3.html">The Canonical Ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="../problems/ps_1/problem_set_1.html">— Problem Set 1 —</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Canonical Ensemble Continued</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture5.html">Generalized Ensembles</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture6.html">The Ideal Gas Partition Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture7.html">The Langmuir Isotherm and Ising Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture8.html">The Ising Model and Mean-Field Theory</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Molecular Simulation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Lecture9.html">Fluctuations and an Introduction to Molecular Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture10.html">Monte Carlo Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture11.html">Monte Carlo and Intro to Molecular Dynamics Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture12.html">MD Thermostats</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture13.html">The Structure of Classical Fluids</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture14.html">The Potential of Mean Force</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Thermodynamics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Lecture15.html">Free energy perturbation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture16.html">Postulates of thermodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture17.html">Heat Engines and Possible Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture18.html">Entropy</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture19.html">The Fundamental Relation of Thermodynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture20.html">Legendre Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture21.html">Conditions of equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture22.html">Equilibrium in single-component systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture23.html">Phase Diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture24.html">Fugacity</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture25.html">Ideal mixtures</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lecture26.html">Non-ideal mixtures</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lecture_files/Lecture4.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Canonical Ensemble Continued</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-readings-for-the-enthusiast">Additional Readings for the Enthusiast</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topics-in-this-lecture">Topics in this lecture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#announcements">Announcements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#derivation-of-canonical-partition-function">Derivation of canonical partition function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#connecting-the-canonical-ensemble-to-thermodynamics">Connecting the canonical ensemble to thermodynamics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#revisiting-the-two-state-system">Revisiting the two-state system</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="canonical-ensemble-continued">
<h1>Canonical Ensemble Continued<a class="headerlink" href="#canonical-ensemble-continued" title="Permalink to this headline">#</a></h1>
<section id="additional-readings-for-the-enthusiast">
<h2>Additional Readings for the Enthusiast<a class="headerlink" href="#additional-readings-for-the-enthusiast" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>- Chapter 3.3-3.5</p></li>
</ul>
</section>
<section id="topics-in-this-lecture">
<h2>Topics in this lecture<a class="headerlink" href="#topics-in-this-lecture" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Canonical partition function</p></li>
<li><p>Thermodynamic connection for canonical ensemble</p></li>
<li><p>Revisiting the two-state system</p></li>
<li><p>Grand canonical partition function</p></li>
</ul>
</section>
<section id="announcements">
<h2>Announcements<a class="headerlink" href="#announcements" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Problem Set 1 due Thursday</p></li>
<li><p>Fill out polls for rescheduled lectures</p></li>
</ul>
</section>
<section id="derivation-of-canonical-partition-function">
<h2>Derivation of canonical partition function<a class="headerlink" href="#derivation-of-canonical-partition-function" title="Permalink to this headline">#</a></h2>
<p>In the last lecture, we began deriving the equations for the canonical
ensemble, or the ensemble in which every microstate is at the same
number of particles, volume, and temperature (<span class="math notranslate nohighlight">\(NVT\)</span>). Unlike the
microcanonical ensemble, the energy of each state can vary, and in
addition the probability of finding a given state is not necessarily
equal. We thus sought to derive the probability of observing a single
state in the canonical ensemble, <span class="math notranslate nohighlight">\(p_j\)</span>, which has energy <span class="math notranslate nohighlight">\(E_j\)</span>. We also
emphasized that in general many possible microstates could have the same
energy but different microscopic configurations - thus, there is not a
one-to-one correspondence between energies and microstates. We will
eventually consider the probability of observing one of the many states
that have the same energy <span class="math notranslate nohighlight">\(E_\nu\)</span> as opposed to the specific microstate
<span class="math notranslate nohighlight">\(j\)</span>.</p>
<p>To determine <span class="math notranslate nohighlight">\(p_j\)</span>, we started by defining a system (indicated by
subscripts <span class="math notranslate nohighlight">\(S\)</span>) in contact with a surrounding bath (indicated by
subscripts <span class="math notranslate nohighlight">\(B\)</span>). The total combined system (indicated by subscripts <span class="math notranslate nohighlight">\(T\)</span>)
is isolated. We assume that the energy of the total combined system can
be partitioned between the system and bath (<span class="math notranslate nohighlight">\(E_T = E_S + E_B\)</span>) where as
the number of particles and volume of both the system and bath are
identical for all microstates of the system. Macroscopically, the
ability of energy to exchange between the system and bath enforces the
thermal equilibrium criterion: <span class="math notranslate nohighlight">\(T_S = T_B\)</span>.</p>
<p>With this system set up, we now seek to determine <span class="math notranslate nohighlight">\(p_j\)</span>. First, we
recognize that the total combined system is isolated, so there is a
microcanonical ensemble of microstates of the total combined system and
the probability of each of these states is equal (according to the
principle of equal a priori probabilities, or Postulate 2 from Lecture
2). We also recognize that each microstate of the total combined system
can be subdivided into the energy and set of particle positions
describing the system and the energy and set of particle positions
describing the bath. We now consider placing the system in microstate
<span class="math notranslate nohighlight">\(j\)</span> with energy <span class="math notranslate nohighlight">\(E_j\)</span>. The resulting bath energy will be
<span class="math notranslate nohighlight">\(E_B = E_T-E_j\)</span>, but there are in principle many possible bath
microstates that have this energy. Since <span class="math notranslate nohighlight">\(E_B\)</span> is fixed by fixing the
energy <span class="math notranslate nohighlight">\(E_j\)</span>, there is thus a microcanonical ensemble of bath
microstates for which the system is in state <span class="math notranslate nohighlight">\(E_j\)</span>. Since <span class="math notranslate nohighlight">\(p_j\)</span> is equal
to the number of total microstates for which the system is in microstate
<span class="math notranslate nohighlight">\(j\)</span>, we can thus say that <span class="math notranslate nohighlight">\(p_j\)</span> is proportional to the degeneracy of the
microcanonical ensemble for which <span class="math notranslate nohighlight">\(E_B= E_T-E_j\)</span>.</p>
<p><img alt="image" src="../_images/fig_3_3.png" />{width=”100%”}</p>
<p>From the logic above, we can write the normalized probability of finding
microstate <span class="math notranslate nohighlight">\(j\)</span> of the system in terms of the degeneracy of the bath as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
p_j &amp;= \frac{\Omega(N_B, V_B, E_T-E_j)}{\sum_j^{\textrm{system microstates}} \Omega(N_B, V_B, E_T-E_j)} \\
&amp;= \frac{\Omega(N_B, V_B, E_T-E_j)}{C_1}
\end{aligned}\end{split}\]</div>
<p>That is, the probability of finding a particular microstate in the
<strong>canonical ensemble</strong> (of the system) is related to the degeneracy of a
bath described by a <strong>microcanonical ensemble</strong> with energy <span class="math notranslate nohighlight">\(E_T-E_j\)</span>.
We use the constant <span class="math notranslate nohighlight">\(C_1\)</span> to refer to the normalization factor in the
denominator (this quantity will drop out later on in the derivation)</p>
<p>Our goal now is to find an expression for <span class="math notranslate nohighlight">\(p_j\)</span> that does not depend on
properties of the bath or total combined system, since in general we
only know the properties of the system itself. To begin, we write the
logarithm of <span class="math notranslate nohighlight">\(p_j\)</span>, recognizing that <span class="math notranslate nohighlight">\(\ln \Omega(N_B, V_B, E_T-E_j)\)</span> is
related to the Boltzmann entropy of the bath:</p>
<div class="math notranslate nohighlight">
\[\ln p_j = \ln  \Omega(N_B, V_B, E_T-E_j) - \ln C_1\]</div>
<p>By construction, the energy of the bath and the energy of the total
combined system is much greater than the energy of the system of
interest (<span class="math notranslate nohighlight">\(E_T \gg E_j\)</span>). We can then write a Taylor expansion for
<span class="math notranslate nohighlight">\(\ln \Omega(N_B, V_B, E_T-E_j)\)</span> around the point <span class="math notranslate nohighlight">\(E_T-E_j \approx E_T\)</span>.
Recall that the expression for a Taylor expansion is:</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
f(x) &amp;= f(a) + f'(a)(x-a) + \frac{f''(a)}{2!}(x-a)^2 \dots 
\end{aligned}\]</div>
<p>For our expansion, <span class="math notranslate nohighlight">\(x = E_T-E_j\)</span>, <span class="math notranslate nohighlight">\(a = E_T\)</span>, and <span class="math notranslate nohighlight">\(x-a = -E_j\)</span>. For these
next few lines, I will use the notation
<span class="math notranslate nohighlight">\(\Omega_B(E) \equiv \Omega(N_B, V_B, E)\)</span> to simplify the notation. The
Taylor expansion is then:</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
\ln  \Omega_B(E_T-E_j) &amp;\approx \ln \Omega_B(E_T) - E_j \left [\frac{\partial  \ln \Omega_B(E_T-E_j)}{\partial (E_T-E_j)} \right ]_{N_B, V_B} + \dots
\end{aligned}\]</div>
<p>We now substitute in the expression for the Boltzmann entropy of the
bath microcanonical ensemble,
<span class="math notranslate nohighlight">\(S_B(E_T - E_j) = k_B \ln \Omega_B(E_T - E_j)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
\ln  \Omega_B(E_T-E_j) &amp;\approx \ln \Omega_B(E_T) - \frac{E_j}{k_B} \left [ \frac{\partial  S_B(E_T-E_j)}{\partial (E_T-E_j)} \right ]_{N_B, V_B} + \dots
\end{aligned}\]</div>
<p>Next, we recognize that
<span class="math notranslate nohighlight">\(\left ( \frac{\partial S_B(E_T-E_j)}{\partial (E_T-E_j)}\right )_{N_B, V_B} = \frac{1}{T_B}\)</span>
using the same thermodynamic relation from last lecture, and moreover
<span class="math notranslate nohighlight">\(1/T_B = 1/T_S\)</span> due to the equilibrium between the system and bath:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\ln  \Omega_B(E_T-E_j) &amp;\approx \ln \Omega_B(E_T) - \frac{E_j}{k_B T_B} + \dots \\
&amp;= \ln \Omega_B(E_T) - \frac{E_j}{k_B T_S} + \dots
\end{aligned}\end{split}\]</div>
<p>Here, we have ignored higher order terms; the next highest order term
would be of the form:</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
\left ( \frac{\partial^2  S_B}{\partial E_B^2} \right ) &amp;=  \left ( \frac{\partial (1/T_B)}{\partial E_B} \right ) \propto \frac{1}{C_V}
\end{aligned}\]</div>
<p>Thus, the second order term is related to the inverse of the heat
capacity of the bath; we can assume that this value is negligible if the
bath is large (i.e., the temperature of the bath is a constant). This is
an assumption about the bath/combined system only, and thus is not
violated even if our system of interest is small!</p>
<p>We can now use this Taylor expansion, truncated at first order, to write
a new expression for the probability of obtaining a system in microstate
<span class="math notranslate nohighlight">\(j\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\ln p_j  &amp;= \ln \Omega_B(E_T) - \frac{E_j}{k_B T_S} - \ln C_1 \\
p_j &amp;= \frac{\Omega_B(E_T)}{C_1} e^{-E_j/k_BT_S} \\
\therefore p_j &amp;= C_2 e^{-E_j/k_BT_S} 
\end{aligned}\end{split}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(C_2\)</span> is a constant the combines the degeneracy of the bath for
some given energy, <span class="math notranslate nohighlight">\(\Omega_B(E_T)\)</span>, with the normalization constant
<span class="math notranslate nohighlight">\(C_1\)</span>. The value <span class="math notranslate nohighlight">\(C_2\)</span> is equivalent for all microstates because it is a
property of our combined system, including the fictitious bath. We can
now identify an expression for <span class="math notranslate nohighlight">\(C_2\)</span> by requiring that <span class="math notranslate nohighlight">\(\sum_j p_j = 1\)</span>
to normalize the probability distribution:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\sum_j^{\textrm{microstates}} p_j &amp;= \sum_j^{\textrm{microstates}} C_2 e^{-E_j/k_BT_S} = C_2 \sum_j^{\textrm{microstates}}  e^{-E_j/k_BT_S} = 1 \\
C_2 &amp;= \frac{1}{\sum_j e^{-E_j/k_BT_S}}\\
\therefore &amp;\boxed{ p_j = \frac{e^{-E_j/k_BT_S}}{\sum_j e^{-E_j/k_BT_S}}}
\end{aligned}\end{split}\]</div>
<p>The term <span class="math notranslate nohighlight">\(\sum_j e^{-E_j/k_BT_S}\)</span>, which normalizes the probability of
finding state <span class="math notranslate nohighlight">\(j\)</span>, is called the <strong>canonical partition function</strong>, which
we denote by <span class="math notranslate nohighlight">\(Z\)</span>. At this point no parameters related to the bath or
total combined system remain in the expression for <span class="math notranslate nohighlight">\(p_j\)</span> - the
probability of identifying a microstate in the canonical ensemble is
related entirely to the system properties without any contribution from
the bath as desired. We will henceforth drop all <span class="math notranslate nohighlight">\(S\)</span> subscripts from
system properties since <span class="math notranslate nohighlight">\(N\)</span>, <span class="math notranslate nohighlight">\(V\)</span>, and <span class="math notranslate nohighlight">\(T\)</span> are no longer ambiguous. The
partition function is then:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
Z &amp;= \sum_j^{\textrm{all states}} e^{-E_j /k_B T} \\
p_j &amp;= \frac{e^{-E_j/k_BT}}{Z}
\end{aligned}\end{split}\]</div>
<p>The weighting term for each state, <span class="math notranslate nohighlight">\(e^{-E_j/k_BT}\)</span>, is referred to as
the <strong>Boltzmann factor</strong> or the <strong>Boltzmann weight</strong> of each state. The
factor <span class="math notranslate nohighlight">\(k_B T\)</span> is essentially a scaling factor and is the amount of
thermal energy accessible to the system. This expression shows that the
probability that a system samples a particular microstate is related to
the relative values of <span class="math notranslate nohighlight">\(E_j\)</span> and <span class="math notranslate nohighlight">\(k_B T\)</span>. Note that probabilities are
exponentially weighted - hence states with low (negative) energies are
exponentially more probable than high energy states. If the energy of a
state is much larger than <span class="math notranslate nohighlight">\(k_B T\)</span>, the probability of observing that
state is very low. Conversely, if the temperature of a system is very
high, the probability of any given state becomes approximately equal
since variations in <span class="math notranslate nohighlight">\(E_j\)</span> between states will be negligible relative to
the value of <span class="math notranslate nohighlight">\(k_BT\)</span>. Often, we will also define <span class="math notranslate nohighlight">\(\beta \equiv 1/k_B T\)</span>
to simplify notation.</p>
<p>So far, we have focused on the energy of a particular microstate,
referring to a particular set of particle configurations and energies.
We can also write the probability <span class="math notranslate nohighlight">\(p_\nu\)</span> of obtaining <strong>any</strong>
microstate of the system of interest that has an energy <span class="math notranslate nohighlight">\(E_\nu\)</span>. In
general, there are many possible microstates that have the same energy,
but have different particle configurations. The number of such states is
given by the microcanonical degeneracy <span class="math notranslate nohighlight">\(\Omega(N_S, V_S, E_\nu)\)</span>, so
<span class="math notranslate nohighlight">\(p_\nu \gg p_j\)</span>. <span class="math notranslate nohighlight">\(p_\nu\)</span> is equal to the probability that the system of
interest is in a particular microstate with energy <span class="math notranslate nohighlight">\(E_j\)</span> (where the
value of <span class="math notranslate nohighlight">\(E_j = E_\nu\)</span>) multiplied by the number of possible microstates
of the system for which <span class="math notranslate nohighlight">\(E_j = E_\nu\)</span>. This gives (again, dropping all
subscripts now):</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
p_\nu &amp;= \Omega(N,V, E_\nu) p_j \\
&amp;= \frac{\Omega(N, V, E_\nu) e^{-\beta E_\nu}}{\sum_\nu^\textrm{energies} \Omega(N, V, E_\nu)   e^{-\beta E_\nu}} \label{canonical_probability}
\end{aligned}\end{split}\]</div>
<p>Here, the denominator is again obtained by normalizing the expression in
the numerator. Since the sums in the denominators of the expressions for
both <span class="math notranslate nohighlight">\(p_j\)</span> and <span class="math notranslate nohighlight">\(p_\nu\)</span> run over all <em>possible</em> states, both are
equivalent. Thus, we can write the partition function of the system as:</p>
<div class="math notranslate nohighlight">
\[Z = \sum_j^{\text{microstates}} e^{-\beta E_j} = \sum_\nu^{\text{energies}} \Omega(N, V, E_\nu)  e^{-\beta E_\nu} \label{canonical_probability2}\]</div>
<p>where again the first form has a sum that runs over all individual
microstates (indicated by the subscript <span class="math notranslate nohighlight">\(j\)</span>) while the second form has a
sum that runs over all possible energy levels (indicated by the
subscript <span class="math notranslate nohighlight">\(\nu\)</span>) and includes the degeneracy associated with each energy
level. The partition function is a constant which normalizes the
probabilities, and since it enumerates all <strong>possible</strong> microstates of
the system (each weighted by a corresponding Boltzmann factor), the
value of the partition function is the same regardless of whether we sum
over microstates or over energy levels. We will next connect the
partition function to macroscopic thermodynamic parameters.</p>
</section>
<section id="connecting-the-canonical-ensemble-to-thermodynamics">
<h2>Connecting the canonical ensemble to thermodynamics<a class="headerlink" href="#connecting-the-canonical-ensemble-to-thermodynamics" title="Permalink to this headline">#</a></h2>
<p>Just as we can use the relation <span class="math notranslate nohighlight">\(S = k_B \ln \Omega(N, V, E)\)</span> to derive
relationships between the degeneracy in the microcanonical ensemble and
various thermodynamic variables through the entropy, we can relate the
canonical partition function to the Helmholtz free energy using the
relation:</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
F &amp;= -k_B T \ln Z (N, V, T)
\end{aligned}\]</div>
<p>We will show this by first deriving an expression for the
ensemble-average energy of the canonical ensemble using the expression
for the partition function. We will then show that invoking the relation
<span class="math notranslate nohighlight">\(F=-k_BT \ln Z\)</span> allows us to equate the ensemble-average energy to the
thermodynamic relationship between the internal energy and the Helmholtz
free energy. First, we can write an expression for the ensemble-average
energy of the canonical ensemble:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\langle E \rangle &amp;= \sum_j^\text{states} p_j E_j \\
&amp;= \sum \left ( \frac{e^{-\beta E_j}}{Z} \right ) E_j \\
&amp;= \frac{1}{Z} \sum_j E_j e^{-\beta E_j} 
\end{aligned}\end{split}\]</div>
<p>Here, we have used the expression for the probability of finding a
particular microstate in the canonical ensemble,
<span class="math notranslate nohighlight">\(p_j \equiv e^{-\beta E_j}/Z\)</span>. We proceed by recognizing that the
derivative of <span class="math notranslate nohighlight">\(e^{-\beta E_j}\)</span> with respect to <span class="math notranslate nohighlight">\(\beta\)</span> is
<span class="math notranslate nohighlight">\(-E_je^{-\beta E_j}\)</span>, allowing us to write:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\langle E \rangle &amp;= \frac{1}{Z} \sum_j - \frac{\partial}{\partial \beta}  \left (e^{-\beta E_j} \right)_{N,V} \\
&amp;= -\frac{1}{Z} \frac{\partial}{\partial \beta}  \left (\sum_j e^{-\beta E_j}\right )_{N,V} \label{distributive_de} \\
&amp;= - \frac{1}{Z} \left ( \frac{\partial Z}{\partial \beta}\right )_{N,V} \\
&amp;= - \left(\frac{\partial \ln Z}{\partial \beta} \right )_{N,V} 
\end{aligned}\end{split}\]</div>
<p>Note that we have used a few tricks to get this last result -
specifically, we note that a sum of derivatives is equivalent to the
derivative of a sum
(<span class="math notranslate nohighlight">\(\sum \frac{\partial X_j}{\partial Y} = \frac{\partial}{\partial Y}\sum X_j\)</span>)
and this sum is equivalent to the partition function, then we use the
chain rule to arrive at the final result, which expresses the
ensemble-average energy in terms of a temperature deriative of the
partition function (since <span class="math notranslate nohighlight">\(\beta = 1/k_B T\)</span>, a derivative with respect
to <span class="math notranslate nohighlight">\(\beta\)</span> is equivalent to a derivative with respect to inverse
temperature).</p>
<p>So far we have assumed no connection to thermodynamics at all. We now
show that deriving an equivalent expression for the internal energy in
terms of a temperature derivative of the Helmholtz free energy allows us
to relate the Helmholtz free energy to the partition function. Let us
now consider the thermodynamic relationship between the Helmholtz free
energy and internal energy from two lectures ago:</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
F = E -TS
\end{aligned}\]</div>
<p>We can also write the total derivative of the Helmholtz free energy (and
substitute in the fundamental relation for <span class="math notranslate nohighlight">\(dE\)</span>) to obtain a
relationship for the entropy to eliminate it from the expression above:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
dF &amp;= dE - TdS - SdT \\
dE &amp;= TdS - PdV + \mu dN \\
dF &amp;= -S dT - PdV + \mu dN \\\label{dF}
&amp;= \left ( \frac{\partial F}{\partial T} \right )_{N,V} dT + \left ( \frac{\partial F}{\partial V} \right )_{N, T} dV + \left ( \frac{\partial F}{\partial N} \right )_{V, T} dN 
\end{aligned}\end{split}\]</div>
<p>This expression then yields:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
S &amp;= -\left ( \frac{\partial F}{\partial T}\right )_{N,V} \\
\therefore E &amp;= F - T \left ( \frac{\partial F}{\partial T}\right )_{N,V}
\end{aligned}\end{split}\]</div>
<p>Letting <span class="math notranslate nohighlight">\(T = k_B/\beta\)</span> we can write:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
E &amp;= F - \frac{k_B}{\beta} \left ( \frac{\partial F}{\partial (k_B/\beta)}\right )_{N,V} \\
%&amp;= F - \frac{1}{\beta} \left ( \frac{\partial F}{\partial \beta}\right )_{N,V} \left ( \frac{\partial %\beta}{\partial \beta^{-1}}\right )_{N,V} \\
&amp;= F + \beta \left ( \frac{\partial F}{\partial \beta}\right )_{N,V} 
\end{aligned}\end{split}\]</div>
<p>We now have the two following expressions, one derived from the
canonical ensemble and one from thermodynamics:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\langle E \rangle &amp;= - \left(\frac{\partial \ln Z}{\partial \beta} \right )_{N,V} \quad \text{stat. mech} \\
E &amp;= F + \beta \left ( \frac{\partial F}{\partial \beta}\right )_{N,V}  \quad \text{thermo}
\end{aligned}\end{split}\]</div>
<p>From ergodicity, we also know that <span class="math notranslate nohighlight">\(\langle E \rangle = E\)</span>, meaning that
the ensemble-average value of <span class="math notranslate nohighlight">\(E\)</span> calculated from statistical mechanics
is equivalent to the thermodynamic definition. We could equate these
expressions to find an expression for <span class="math notranslate nohighlight">\(F\)</span>. Doing so would lead to:</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
F &amp;= -k_B T \ln Z = -(1/\beta) \ln Z
\end{aligned}\]</div>
<p>We can confirm this relationship by substituting it into the first
expression to check for consistency:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\langle E \rangle &amp;= \left(\frac{\partial (\beta F)}{\partial \beta} \right )_{N,V}  \\ 
&amp;= F + \beta \left ( \frac{\partial F}{\partial \beta}\right )_{N,V} \\
&amp;= E \quad \text{ from thermo}
\end{aligned}\end{split}\]</div>
<p>Therefore, substituting in our putative link between the partition
function and the Helmholtz free energy correctly derives the same
expression obtained from thermodynamics alone (given the equivalence
between ensemble-average energy and macroscopic energy according to
Postulate 1). This confirms the relationship between the Helmholtz free
energy and the canonical partition function. To summarize, our three
critical relationships for the canonical ensemble are then:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
Z &amp;= \sum_j^{\text{microstates}} e^{-\beta E_j} = \sum_\nu^{\text{energies}} \Omega(N,V,E_\nu) e^{-\beta E_\nu}\\
p_j &amp;= \frac{e^{-\beta E_j}}{Z} \\
F &amp;= -k_B T \ln Z(N,V,T)
\end{aligned}\end{split}\]</div>
</section>
<section id="revisiting-the-two-state-system">
<h2>Revisiting the two-state system<a class="headerlink" href="#revisiting-the-two-state-system" title="Permalink to this headline">#</a></h2>
<p>To illustrate how a judicious choice of statistical ensemble can
simplify the analysis of systems, we will repeat the example from
Lecture 2 using the canonical ensemble, instead of the microcanonical
ensemble. Recall that the system under consideration is a polymer
adsorbed to a surface with <span class="math notranslate nohighlight">\(N\)</span> total monomers in the chain, of which <span class="math notranslate nohighlight">\(n\)</span>
are adsorbed to the surface with an energy <span class="math notranslate nohighlight">\(-\epsilon\)</span>. The total energy
of the system is then <span class="math notranslate nohighlight">\(E = -n \epsilon\)</span> and we seek to relate the number
of adsorbed monomers to the temperature. Previously, we solved this
problem using the microcanonical ensemble by first solving for the
relationship between the entropy, <span class="math notranslate nohighlight">\(S\)</span>, and the number of adsorbed
monomers, then identifying a temperature dependence via derivative of
the entropy. If we instead treat the system using the canonical ensemble
by assuming that the energy of the system is allowed to vary (i.e., the
number of adsorbed monomers varies) and only the temperature is held
fixed, we can directly relate temperature to energy. We will solve this
problem in two ways.</p>
<p>In our first approach, we recognize that all monomers adsorb
independently of each other, so the number of adsorbed monomers in a
given microstate of the canonical ensemble is <span class="math notranslate nohighlight">\(n_i = N \rho\)</span>, where
<span class="math notranslate nohighlight">\(\rho\)</span> is the probability that a single monomer adsorbs (this is
equivalent to the ensemble average of <span class="math notranslate nohighlight">\(n\)</span> if <span class="math notranslate nohighlight">\(N=1\)</span>). Since the monomers
are independent, the probability that one monomer adsorbs does not
affect the probability that another monomer adsorbs. Therefore, we can
instead consider a single monomer as a system, in which case the
canonical ensemble for a single monomer has only two microstates: either
adsorbed or not adsorbed. For a single monomer we can write that the
probability of adsorbing in the canonical ensemble is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\rho &amp;= \frac{e^{-\beta E_\textrm{adsorb}}}{\sum_j^\text{microstates} e^{-\beta E_j}} \\
&amp;= \frac{e^{\beta \epsilon}}{e^{-\beta(0)} + e^{\beta(\epsilon)} }  \\
&amp;= \frac{e^{\beta \epsilon}}{1 + e^{\beta\epsilon}} 
\end{aligned}\end{split}\]</div>
<p>Here, we have explicitly enumerated both states in the partition
function. The ensemble-average number of adsorbed monomers is then:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\langle n \rangle &amp;= N \rho \\
&amp;= \frac{ N  e^{\beta \epsilon}}{1 + e^{\beta\epsilon}} \\
&amp;= \frac{N}{1 + e^{-\beta\epsilon}}
\end{aligned}\end{split}\]</div>
<p>This result is the same expression that was derived using the
microcanonical ensemble and is obtained much more easily. Note the key
steps: we assume that the monomers are independent, we calculate the
probability of adsorbing for each monomer, then multiply this
probability by the number of monomers. This assumption of independent
treatment of a set of identical systems will be discussed further in
future lectures.</p>
<p>We can also obtain this result directly from the canonical partition
function. Here we will use <span class="math notranslate nohighlight">\(z\)</span> to represent the partition function for
adsorbing a single monomer (with two terms as above) and let
<span class="math notranslate nohighlight">\(\langle \epsilon \rangle\)</span> be the ensemble-average energy per monomer.
The ensemble-average number of adsorbed monomers is then
<span class="math notranslate nohighlight">\(\langle n \rangle = -N \langle \epsilon \rangle / \epsilon\)</span>. Using a
relation from above we can then write:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\langle \epsilon \rangle &amp;=  -\left(\frac{\partial \ln z}{\partial \beta} \right )_{N,V}  \\ 
&amp;= -\left ( \frac{\partial \ln (1 + e^{\beta\epsilon})}{\partial \beta} \right )_{N, V} \\
&amp;= -\frac{\epsilon e^{\beta \epsilon}}{1+e^{\beta \epsilon}} \\
 \langle n \rangle &amp;= -N \langle \epsilon \rangle / \epsilon \\
&amp;= \frac{N }{1 + e^{-\beta \epsilon}} \label{eq:3.37}
\end{aligned}\end{split}\]</div>
<p>This approach again returns the same result.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lecture_files"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../problems/ps_1/problem_set_1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">— Problem Set 1 —</p>
      </div>
    </a>
    <a class="right-next"
       href="Lecture5.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Generalized Ensembles</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-readings-for-the-enthusiast">Additional Readings for the Enthusiast</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topics-in-this-lecture">Topics in this lecture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#announcements">Announcements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#derivation-of-canonical-partition-function">Derivation of canonical partition function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#connecting-the-canonical-ensemble-to-thermodynamics">Connecting the canonical ensemble to thermodynamics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#revisiting-the-two-state-system">Revisiting the two-state system</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Reid van Lehn, Matt Gebbie, Rose Cersonsky
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>